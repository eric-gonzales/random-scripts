# Simple Groovy Script to return the most recent security vulnerability for Apache Tomcat
final BASE_URL = 'http://www.cvedetails.com/vulnerability-feed.php?vendor_id=45&product_id=887&version_id=0&orderby=1&cvssscoremin=0'

# Have to change user agent in order for the feed to work
System.setProperty("http.agent", "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.4; en-US; rv:1.9.2.2) Gecko/20100316 Firefox/3.6.2");

BASE_URL.toURL().withReader { r ->
    def feed = new XmlSlurper(false, false).parse(r).channel.item.first()
    def title = feed.title.toString()
    def description = feed.description.toString()
    def pubDate = feed.pubDate.toString()
    def date = Date.parse("yyyy-MM-dd", pubDate).format("MMMMM d, yyyy")

    println title
    println description
    println date
}
